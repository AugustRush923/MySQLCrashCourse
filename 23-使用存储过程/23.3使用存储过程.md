# 使用存储过程

## 创建存储过程

通过`CREATE PROCEDURE`关键字即可创建存储过程：

```sql
CREATE PROCEDURE productpricing()
BEGIN
    SELECT Avg(prod_price) AS priceaverage,
    Min(prod_price) AS pricelow,
    Max(prod_price) AS pricehigh
    FROM products
END;
```

此存储过程名为`productpricing`,用`CREATE PROCEDURE productpricing()`语句定义。如果存储过程接受参数，它们将在`()`中列举出来。此存储过程没有参数，但后面的`()`仍然需要。`BEGIN`和`END`语句用来限定存储过程体，过程体本身仅是一个简单的SELECT语句。

在MySQL处理这段代码时，它创建一个新的存储过程`productpricing`。没有返回数据，因为这段代码并未调用存储过程，这里只是为以后使用而创建它。

## 执行存储过程

MySQL称存储过程的执行为调用，因此MySQL执行存储过程的语句为`CALL`。CALL接受存储过程的名字以及需要传递给它的任意参数。

```sql
CALL productpricing();
```

这条语句的意思是，执行名为`productpricing`的存储过程，它计算并返回产品的最低、最高和平均价格。

存储过程可以显示结果，也可以不显示结果。

## 删除存储过程

存储过程在创建之后，被保存在服务器上以供使用，直至被删除。

命令为：

```sql
DROP PROCEDURE productpricing;
```

如果指定的过程不存在，这`DROP PROCEDURE`将产生一个错误。当过程存在想删除它时（如果过程不存在也不产生错误）可使用`DROP PROCEDUREIF EXISTS`。

## 使用参数

`productpricing`只是一个简单的存储过程，它简单地显示`SELECT`语句的结果。一般，存储过程并不显示结果，而是把结果返回给你指定的变量。

```sql
CREATE PROCEDURE productpricing(
    OUT pl DECIMAL(8, 2),
    OUT ph DECIMAL(8, 2),
    OUT pa DECIMAL(8, 2)
)
BEGIN
    SELECT Avg(prod_price) INTO pa FROM products;
    SELECT Min(prod_price) INTO pl FROM products;
    SELECT Max(prod_price) INTO ph FROM products;
END;
```

此存储过程接受3个参数：pl，ph和pa。每个参数必须具有指定的类型。关键字`OUT`指出相应的参数用来从存储过程中传出一个值。
MySQL支持`IN`传递给存储过程、`OUT`从存储过程传出。`INOUT`对存储过程传入和传出
